{
  "profiles": [
    {
      "name":"default",
      "description":"Default RESTful C2 channel",
      "author": "@its_a_feature_",
      "params":[
      {
        "name":"callback host",
        "key":"callback_host",
        "hint":"http(s):\/\/domain.com"
      },
      {
        "name":"callback port",
        "key":"callback_port",
        "hint":"80"
      },
      {
        "name":"callback interval (in seconds)",
        "key":"callback_interval",
        "hint":"10"
      },
      {
        "name": "callback jitter (in percent)",
        "key": "callback_jitter",
        "hint": "37"
      },
      {
        "name":"Host header (for domain fronting)",
        "key":"domain_front",
        "hint":""
      },
      {
        "name": "Encrypted Key Exchange (T/F)",
        "key": "encrypted_exchange_check",
        "hint": "T"
      },
      {
        "name": "Base64 32byte AES Key",
        "key": "AESPSK",
        "hint": ""
      }
    ],
      "payload_types": ["apfell-jxa", "poseidon", "viper"],
      "notes": "This profile does not have an associated docker container. Instead, the agents connect in straight to the Apfell server or through an external redirector. The 'apfell-jxa' agent cannot connect to self-signed certs, so keep that in mind when standing up infrastructure.",
      "sampleServer": "",
      "sampleClient": "When setting parameters:\ncallback_host should be 'http://domain.com', 'https://domain.com'.\n'Base64 32byte AES Key' is auto-generated per operation and automatically filled in if the key name is 'AESPSK'. This value must be set for static pre-shared key comms or encrypted key  exchange comms. You can change it to be any base64 of 32 bytes.\nBy default, the payloads will do an encrypted key exchange of some sort"
    },
    {
      "name":"RESTful_Patchthrough",
      "author": "@its_a_feature_",
      "description":"Modify default RESTful interfaces for callback. Parameters must match up with server though (manual process)",
      "params":[
      {
        "name":"callback host",
        "key":"callback_host",
        "hint":"http(s):\/\/domain.com"
      },
      {
        "name":"callback port",
        "key":"callback_port",
        "hint":"9000"
      },
      {
        "name":"callback interval (in seconds)",
        "key":"callback_interval",
        "hint":"10"
      },
      {
        "name": "callback jitter (in percent)",
        "key": "callback_jitter",
        "hint": "37"
      },
      {
        "name":"Get a File (for load/download)",
        "key":"GETFILE",
        "hint":"\/download.php?ID=*"
      },
      {
        "name":"Get next task",
        "key":"GETNEXTTASK",
        "hint":"\/admin.php?q=*"
      },
      {
        "name":"ID Field (some string to represent where variables go in the URI)",
        "key":"IDSTRING",
        "hint":"*"
      },
      {
        "name":"cleartext new callback",
        "key":"NEWCALLBACK",
        "hint":"\/login"
      },
      {
        "name": "AES pre-shared key new callback",
        "key": "AES_PSK_NEW_CALLBACK",
        "hint": "\/register.php?SessionID=*"
      },
      {
        "name": "Encrypted Key Exchange new callback",
        "key": "EKE_NEW_CALLBACK",
        "hint": "\/signup.php?SessionID=*"
      },
      {
        "name":"Post responses",
        "key":"POSTRESPONSE",
        "hint":"\/upload.php?page=*"
      },
      {
        "name":"Host header (for domain fronting)",
        "key":"domain_front",
        "hint":""
      },
      {
        "name": "Encrypted Key Exchange (T/F)",
        "key": "encrypted_exchange_check",
        "hint": "T"
      },
      {
        "name": "Base64 32byte AES Key",
        "key": "AESPSK",
        "hint": ""
      },
      {
        "name": "Diffie-Hellman based Encrypted Key Exchange new callback",
        "key": "EKE_DH_NEW_CALLBACK",
        "hint": "\/recover_account.php?SessionID=*"
      }
    ],
      "payload_types": ["apfell-jxa", "viper", "poseidon"],
      "notes": "",
      "sampleServer": "",
      "sampleClient": ""
    },
    {
      "name": "HTTP",
      "description": "Manipulate HTTP(S) requests and responses",
      "author": "@its_a_feature_",
      "params": [
        {
          "name": "Base64 32byte AES Key",
          "key": "AESPSK",
          "hint": ""
        },
        {
          "name": "Agent JSON Config",
          "key": "raw_c2_config",
          "hint": ""
        }
      ],
      "payload_types": ["apfell-jxa", "viper"],
      "notes": "",
      "sampleServer": "",
      "sampleClient": ""
    }
  ]
}